### Data Preprocessing and Model Inputs

This folder contains scripts for preprocessing MEG and diffusion MRI (dMRI) data and preparing input files for modeling. 
---

## **ðŸ“‚ Scripts and Outputs**

### **1. Early MEG Preprocessing (Script 1: `1_EarlyEvokedMEG.m`)**
- **Purpose:** Preprocess MEG data, apply ICA artifact rejection, and extract trial-averaged evoked responses for "verb" and "noise" conditions.
- **Dependencies:** MATLAB, FieldTrip toolbox.
- **Outputs (per subject):**
  - `verb.npy` â†’ NumPy array of averaged evoked responses for the "verb" condition.
  - `noise.npy` â†’ NumPy array of averaged evoked responses for the "noise" condition.

---

### **2. Distance Matrix Calculation (Script 2: `2_distancemat.m`)**
- **Purpose:** Generates a subject-specific Shen atlas in individual space and computes the Euclidean distance matrix between brain regions.
- **Dependencies:** MATLAB, SPM toolbox.
- **Outputs (per subject):**
  - `distance.txt` â†’ Distance matrix (Euclidean distance between brain regions).
  - `shen_in_individual_space_shen_atlas.nii` â†’ Subject-specific Shen atlas in individual space (used in Script 3).

---

### **3. Structural Connectivity Matrix Extraction (Script 3: `3_WeightsfromDwMRI.sh`)**
- **Purpose:** Processes diffusion MRI (dMRI) data to compute subject-specific structural connectivity matrices based on the Shen atlas.
- **Dependencies:** FreeSurfer, FSL, MRtrix3, ANTs.
- **Outputs (per subject):**
  - `shen_indiv.csv` â†’ Structural connectivity matrix (weights matrix used for modeling).

---

## **ðŸ“Š Summary of Model Inputs**
| File Name | Generated By | Description |
|-----------|-------------|-------------|
| `verb.npy` | `1_EarlyEvokedMEG.m` | Averaged evoked response for verb trials (NumPy format). |
| `noise.npy` | `1_EarlyEvokedMEG.m` | Averaged evoked response for noise trials (NumPy format). |
| `distance.txt` | `2_distancemat.m` | Euclidean distance matrix between brain regions. |
| `shen_indiv.csv` | `3_WeightsfromDwMRI.sh` | Structural connectivity matrix (weights for modeling). |

---

## **ðŸ’¡ Usage Instructions**
### **Step 1: Preprocess MEG Data**
Run `1_EarlyEvokedMEG.m` in MATLAB to generate `verb.npy` and `noise.npy` files.

### **Step 2: Generate Distance Matrix**
Run `2_distancemat.m` in MATLAB to compute `distance.txt` and generate `shen_in_individual_space_shen_atlas.nii`.

### **Step 3: Compute Structural Connectivity**
Run `3_WeightsfromDwMRI.sh` on a high-performance computing cluster or Linux environment to generate `shen_indiv.csv`, uses `shen_in_individual_space_shen_atlas.nii` from step 2.

